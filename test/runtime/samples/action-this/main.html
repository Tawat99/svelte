<script>
	export let x;

	function foo(node) {
		let x = 0;

		const handler = () => x = x++;

		node.addEventListener('click', handler);
		handler();

		return {
			destroy() {
				node.removeEventListener('click', handler);
			}
		};
	}
</script>

<button use:foo>{x}</button>